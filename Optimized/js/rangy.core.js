window.rangy=function(){function e(b,c){var d=typeof b[c];return"function"==d||!("object"!=d||!b[c])||"unknown"==d}function x(b,c){return!("object"!=typeof b[c]||!b[c])}function u(b,c){return"undefined"!=typeof b[c]}function v(b){return function(c,d){for(var B=d.length;B--;)if(!b(c,d[B]))return!1;return!0}}function q(b){return b&&r(b,n)&&m(b,l)}function s(c){window.alert("Rangy not supported in your browser. Reason: "+c);b.initialized=!0;b.supported=!1}function A(){if(!b.initialized){var h,t=!1,l=
!1;e(document,"createRange")&&(h=document.createRange(),r(h,p)&&m(h,d)&&(t=!0),h.detach());(h=x(document,"body")?document.body:document.getElementsByTagName("body")[0])&&e(h,"createTextRange")&&(h=h.createTextRange(),q(h)&&(l=!0));t||l||s("Neither Range nor TextRange are implemented");b.initialized=!0;b.features={implementsDomRange:t,implementsTextRange:l};t=B.concat(c);l=0;for(h=t.length;l<h;++l)try{t[l](b)}catch(n){x(window,"console")&&e(window.console,"log")&&window.console.log("Init listener threw an exception. Continuing.",
n)}}}function C(b){this.name=b;this.supported=this.initialized=!1}var d="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer START_TO_START START_TO_END END_TO_START END_TO_END".split(" "),p="setStart setStartBefore setStartAfter setEnd setEndBefore setEndAfter collapse selectNode selectNodeContents compareBoundaryPoints deleteContents extractContents cloneContents insertNode surroundContents cloneRange toString detach".split(" "),l="boundingHeight boundingLeft boundingTop boundingWidth htmlText text".split(" "),
n="collapse compareEndPoints duplicate getBookmark moveToBookmark moveToElementText parentElement pasteHTML select setEndPoint getBoundingClientRect".split(" "),r=v(e),h=v(x),m=v(u),b={version:"1.2.3",initialized:!1,supported:!0,util:{isHostMethod:e,isHostObject:x,isHostProperty:u,areHostMethods:r,areHostObjects:h,areHostProperties:m,isTextRange:q},features:{},modules:{},config:{alertOnWarn:!1,preferTextRange:!1}};b.fail=s;b.warn=function(c){c="Rangy warning: "+c;b.config.alertOnWarn?window.alert(c):
"undefined"!=typeof window.console&&"undefined"!=typeof window.console.log&&window.console.log(c)};({}).hasOwnProperty?b.util.extend=function(b,c){for(var d in c)c.hasOwnProperty(d)&&(b[d]=c[d])}:s("hasOwnProperty not supported");var c=[],B=[];b.init=A;b.addInitListener=function(d){b.initialized?d(b):c.push(d)};var t=[];b.addCreateMissingNativeApiListener=function(b){t.push(b)};b.createMissingNativeApi=function(b){b=b||window;A();for(var c=0,d=t.length;c<d;++c)t[c](b)};C.prototype.fail=function(b){this.initialized=
!0;this.supported=!1;throw Error("Module '"+this.name+"' failed to load: "+b);};C.prototype.warn=function(c){b.warn("Module "+this.name+": "+c)};C.prototype.createError=function(b){return Error("Error in Rangy "+this.name+" module: "+b)};b.createModule=function(c,d){var e=new C(c);b.modules[c]=e;B.push(function(b){d(b,e);e.initialized=!0;e.supported=!0})};b.requireModules=function(c){for(var d=0,B=c.length,e,h;d<B;++d){h=c[d];e=b.modules[h];if(!(e&&e instanceof C))throw Error("Module '"+h+"' not found");
if(!e.supported)throw Error("Module '"+h+"' not supported");}};var F=!1,h=function(){F||(F=!0,b.initialized||A())};if("undefined"==typeof window)s("No window found");else if("undefined"==typeof document)s("No document found");else return e(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",h,!1),e(window,"addEventListener")?window.addEventListener("load",h,!1):e(window,"attachEvent")?window.attachEvent("onload",h):s("Window does not have required addEventListener or attachEvent method"),
b}();
rangy.createModule("DomUtil",function(e,x){function u(b){for(var c=0;b=b.previousSibling;)c++;return c}function v(b,c){var d=[],e;for(e=b;e;e=e.parentNode)d.push(e);for(e=c;e;e=e.parentNode)if(m(d,e))return e;return null}function q(b,c,d){for(d=d?b:b.parentNode;d;){b=d.parentNode;if(b===c)return d;d=b}return null}function s(b){b=b.nodeType;return 3==b||4==b||8==b}function A(b,c){var d=c.nextSibling,e=c.parentNode;d?e.insertBefore(b,d):e.appendChild(b);return b}function C(b){if(9==b.nodeType)return b;if("undefined"!=
typeof b.ownerDocument)return b.ownerDocument;if("undefined"!=typeof b.document)return b.document;if(b.parentNode)return C(b.parentNode);throw Error("getDocument: no document found for node");}function d(b){return b?s(b)?'"'+b.data+'"':1==b.nodeType?"<"+b.nodeName+(b.id?' id="'+b.id+'"':"")+">["+b.childNodes.length+"]":b.nodeName:"[No node]"}function p(b){this._next=this.root=b}function l(b,c){this.node=b;this.offset=c}function n(b){this.code=this[b];this.codeName=b;this.message="DOMException: "+
this.codeName}var r=e.util;r.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||x.fail("document missing a Node creation method");r.isHostMethod(document,"getElementsByTagName")||x.fail("document missing getElementsByTagName method");var h=document.createElement("div");r.areHostMethods(h,["insertBefore","appendChild","cloneNode"])||x.fail("Incomplete Element implementation");r.isHostProperty(h,"innerHTML")||x.fail("Element is missing innerHTML property");h=document.createTextNode("test");
r.areHostMethods(h,["splitText","deleteData","insertData","appendData","cloneNode"])||x.fail("Incomplete Text Node implementation");var m=function(b,c){for(var d=b.length;d--;)if(b[d]===c)return!0;return!1};p.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var b=this._current=this._next,c;if(this._current){if(!(c=b.firstChild))for(c=null;b!==this.root&&!(c=b.nextSibling);)b=b.parentNode;this._next=c}return this._current},detach:function(){this._current=this._next=this.root=
null}};l.prototype={equals:function(b){return this.node===b.node&this.offset==b.offset},inspect:function(){return"[DomPosition("+d(this.node)+":"+this.offset+")]"}};n.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11};n.prototype.toString=function(){return this.message};e.dom={arrayContains:m,isHtmlNamespace:function(b){var c;return"undefined"==typeof b.namespaceURI||null===(c=b.namespaceURI)||
"http://www.w3.org/1999/xhtml"==c},parentElement:function(b){b=b.parentNode;return 1==b.nodeType?b:null},getNodeIndex:u,getNodeLength:function(b){var c;return s(b)?b.length:(c=b.childNodes)?c.length:0},getCommonAncestor:v,isAncestorOf:function(b,c,d){for(c=d?c:c.parentNode;c;){if(c===b)return!0;c=c.parentNode}return!1},getClosestAncestorIn:q,isCharacterDataNode:s,insertAfter:A,splitDataNode:function(b,c){var d=b.cloneNode(!1);d.deleteData(0,c);b.deleteData(c,b.length-c);A(d,b);return d},getDocument:C,
getWindow:function(b){b=C(b);if("undefined"!=typeof b.defaultView)return b.defaultView;if("undefined"!=typeof b.parentWindow)return b.parentWindow;throw Error("Cannot get a window object for node");},getIframeWindow:function(b){if("undefined"!=typeof b.contentWindow)return b.contentWindow;if("undefined"!=typeof b.contentDocument)return b.contentDocument.defaultView;throw Error("getIframeWindow: No Window object found for iframe element");},getIframeDocument:function(b){if("undefined"!=typeof b.contentDocument)return b.contentDocument;
if("undefined"!=typeof b.contentWindow)return b.contentWindow.document;throw Error("getIframeWindow: No Document object found for iframe element");},getBody:function(b){return r.isHostObject(b,"body")?b.body:b.getElementsByTagName("body")[0]},getRootContainer:function(b){for(var c;c=b.parentNode;)b=c;return b},comparePoints:function(b,c,d,e){var h;if(b==d)return c===e?0:c<e?-1:1;if(h=q(d,b,!0))return c<=u(h)?-1:1;if(h=q(b,d,!0))return u(h)<e?-1:1;c=v(b,d);b=b===c?c:q(b,c,!0);d=d===c?c:q(d,c,!0);if(b===
d)throw Error("comparePoints got to case 4 and childA and childB are the same!");for(c=c.firstChild;c;){if(c===b)return-1;if(c===d)return 1;c=c.nextSibling}throw Error("Should not be here!");},inspectNode:d,fragmentFromNodeChildren:function(b){for(var c=C(b).createDocumentFragment(),d;d=b.firstChild;)c.appendChild(d);return c},createIterator:function(b){return new p(b)},DomPosition:l};e.DOMException=n});
rangy.createModule("DomRange",function(e){function x(g,a){return 3!=g.nodeType&&(f.isAncestorOf(g,a.startContainer,!0)||f.isAncestorOf(g,a.endContainer,!0))}function u(g){return f.getDocument(g.startContainer)}function v(g,a,b){if(a=g._listeners[a])for(var c=0,k=a.length;c<k;++c)a[c].call(g,{target:g,args:b})}function q(g){return new L(g.parentNode,f.getNodeIndex(g))}function s(g){return new L(g.parentNode,f.getNodeIndex(g)+1)}function A(g,a,b){var c=11==g.nodeType?g.firstChild:g;f.isCharacterDataNode(a)?
b==a.length?f.insertAfter(g,a):a.parentNode.insertBefore(g,0==b?a:f.splitDataNode(a,b)):b>=a.childNodes.length?a.appendChild(g):a.insertBefore(g,a.childNodes[b]);return c}function C(g){for(var a,b,c=u(g.range).createDocumentFragment();b=g.next();){a=g.isPartiallySelectedSubtree();b=b.cloneNode(!a);a&&(a=g.getSubtreeIterator(),b.appendChild(C(a)),a.detach(!0));if(10==b.nodeType)throw new E("HIERARCHY_REQUEST_ERR");c.appendChild(b)}return c}function d(g,a,b){var c,k;for(b=b||{stop:!1};c=g.next();)if(g.isPartiallySelectedSubtree())if(!1===
a(c)){b.stop=!0;break}else{if(c=g.getSubtreeIterator(),d(c,a,b),c.detach(!0),b.stop)break}else for(c=f.createIterator(c);k=c.next();)if(!1===a(k)){b.stop=!0;return}}function p(g){for(var a;g.next();)g.isPartiallySelectedSubtree()?(a=g.getSubtreeIterator(),p(a),a.detach(!0)):g.remove()}function l(g){for(var a,b=u(g.range).createDocumentFragment(),c;a=g.next();){g.isPartiallySelectedSubtree()?(a=a.cloneNode(!1),c=g.getSubtreeIterator(),a.appendChild(l(c)),c.detach(!0)):g.remove();if(10==a.nodeType)throw new E("HIERARCHY_REQUEST_ERR");
b.appendChild(a)}return b}function n(g,a,b){var c=!(!a||!a.length),k,e=!!b;c&&(k=RegExp("^("+a.join("|")+")$"));var f=[];d(new h(g,!1),function(g){c&&!k.test(g.nodeType)||e&&!b(g)||f.push(g)});return f}function r(g){return"["+("undefined"==typeof g.getName?"Range":g.getName())+"("+f.inspectNode(g.startContainer)+":"+g.startOffset+", "+f.inspectNode(g.endContainer)+":"+g.endOffset+")]"}function h(g,a){this.range=g;this.clonePartiallySelectedTextNodes=a;if(!g.collapsed){this.sc=g.startContainer;this.so=
g.startOffset;this.ec=g.endContainer;this.eo=g.endOffset;var b=g.commonAncestorContainer;this.sc===this.ec&&f.isCharacterDataNode(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==b||f.isCharacterDataNode(this.sc)?f.getClosestAncestorIn(this.sc,b,!0):this.sc.childNodes[this.so],this._last=this.ec!==b||f.isCharacterDataNode(this.ec)?f.getClosestAncestorIn(this.ec,b,!0):this.ec.childNodes[this.eo-1])}}function m(g){this.code=this[g];
this.codeName=g;this.message="RangeException: "+this.codeName}function b(g,a,b){this.nodes=n(g,a,b);this._next=this.nodes[0];this._position=0}function c(g){return function(a,b){for(var c,k=b?a:a.parentNode;k;){c=k.nodeType;if(f.arrayContains(g,c))return k;k=k.parentNode}return null}}function B(g,a){if(ea(g,a))throw new m("INVALID_NODE_TYPE_ERR");}function t(g){if(!g.startContainer)throw new E("INVALID_STATE_ERR");}function F(g,a){if(!f.arrayContains(a,g.nodeType))throw new m("INVALID_NODE_TYPE_ERR");
}function O(g,a){if(0>a||a>(f.isCharacterDataNode(g)?g.length:g.childNodes.length))throw new E("INDEX_SIZE_ERR");}function H(a,b){if(D(a,!0)!==D(b,!0))throw new E("WRONG_DOCUMENT_ERR");}function G(a){if(fa(a,!0))throw new E("NO_MODIFICATION_ALLOWED_ERR");}function z(a,b){if(!a)throw new E(b);}function J(a){return!!a.startContainer&&!!a.endContainer&&!(!f.arrayContains(P,a.startContainer.nodeType)&&!D(a.startContainer,!0))&&!(!f.arrayContains(P,a.endContainer.nodeType)&&!D(a.endContainer,!0))&&a.startOffset<=
(f.isCharacterDataNode(a.startContainer)?a.startContainer.length:a.startContainer.childNodes.length)&&a.endOffset<=(f.isCharacterDataNode(a.endContainer)?a.endContainer.length:a.endContainer.childNodes.length)}function w(a){t(a);if(!J(a))throw Error("Range error: Range is no longer valid after DOM mutation ("+a.inspect()+")");}function Q(){}function K(a){a.START_TO_START=V;a.START_TO_END=Z;a.END_TO_END=ga;a.END_TO_START=$;a.NODE_BEFORE=aa;a.NODE_AFTER=ba;a.NODE_BEFORE_AND_AFTER=ca;a.NODE_INSIDE=W}
function I(a){K(a);K(a.prototype)}function R(a,b){return function(){w(this);var c=this.startContainer,k=this.startOffset,e=this.commonAncestorContainer,D=new h(this,!0);c!==e&&(c=f.getClosestAncestorIn(c,e,!0),k=s(c),c=k.node,k=k.offset);d(D,G);D.reset();e=a(D);D.detach();b(this,c,k,c,k);return e}}function T(a,b,c){function d(a,g){return function(b){t(this);F(b,M);F(k(b),P);b=(a?q:s)(b);(g?D:m)(this,b.node,b.offset)}}function D(a,g,c){var d=a.endContainer,e=a.endOffset;if(g!==a.startContainer||c!==
a.startOffset){if(k(g)!=k(d)||1==f.comparePoints(g,c,d,e))d=g,e=c;b(a,g,c,d,e)}}function m(a,g,c){var d=a.startContainer,e=a.startOffset;if(g!==a.endContainer||c!==a.endOffset){if(k(g)!=k(d)||-1==f.comparePoints(g,c,d,e))d=g,e=c;b(a,d,e,g,c)}}a.prototype=new Q;e.util.extend(a.prototype,{setStart:function(a,g){t(this);B(a,!0);O(a,g);D(this,a,g)},setEnd:function(a,g){t(this);B(a,!0);O(a,g);m(this,a,g)},setStartBefore:d(!0,!0),setStartAfter:d(!1,!0),setEndBefore:d(!0,!1),setEndAfter:d(!1,!1),collapse:function(a){w(this);
a?b(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):b(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){t(this);B(a,!0);b(this,a,0,a,f.getNodeLength(a))},selectNode:function(a){t(this);B(a,!1);F(a,M);var g=q(a);a=s(a);b(this,g.node,g.offset,a.node,a.offset)},extractContents:R(l,b),deleteContents:R(p,b),canSurroundContents:function(){w(this);G(this.startContainer);G(this.endContainer);var a=new h(this,!0),g=a._first&&
x(a._first,this)||a._last&&x(a._last,this);a.detach();return!g},detach:function(){c(this)},splitBoundaries:function(){w(this);var a=this.startContainer,g=this.startOffset,c=this.endContainer,k=this.endOffset,d=a===c;f.isCharacterDataNode(c)&&0<k&&k<c.length&&f.splitDataNode(c,k);f.isCharacterDataNode(a)&&0<g&&g<a.length&&(a=f.splitDataNode(a,g),d?(k-=g,c=a):c==a.parentNode&&k>=f.getNodeIndex(a)&&k++,g=0);b(this,a,g,c,k)},normalizeBoundaries:function(){w(this);var a=this.startContainer,g=this.startOffset,
c=this.endContainer,k=this.endOffset,d=function(a){var g=a.nextSibling;g&&g.nodeType==a.nodeType&&(c=a,k=a.length,a.appendData(g.data),g.parentNode.removeChild(g))},e=function(b){var d=b.previousSibling;if(d&&d.nodeType==b.nodeType){a=b;var e=b.length;g=d.length;b.insertData(0,d.data);d.parentNode.removeChild(d);a==c?(k+=g,c=a):c==b.parentNode&&(d=f.getNodeIndex(b),k==d?(c=b,k=e):k>d&&k--)}},D=!0;f.isCharacterDataNode(c)?c.length==k&&d(c):(0<k&&(D=c.childNodes[k-1])&&f.isCharacterDataNode(D)&&d(D),
D=!this.collapsed);D?f.isCharacterDataNode(a)?0==g&&e(a):g<a.childNodes.length&&(d=a.childNodes[g])&&f.isCharacterDataNode(d)&&e(d):(a=c,g=k);b(this,a,g,c,k)},collapseToPoint:function(a,g){t(this);B(a,!0);O(a,g);a===this.startContainer&&g===this.startOffset&&a===this.endContainer&&g===this.endOffset||b(this,a,g,a,g)}});I(a)}function S(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset;a.commonAncestorContainer=a.collapsed?a.startContainer:f.getCommonAncestor(a.startContainer,
a.endContainer)}function U(a,b,c,k,d){var e=a.startContainer!==b||a.startOffset!==c,f=a.endContainer!==k||a.endOffset!==d;a.startContainer=b;a.startOffset=c;a.endContainer=k;a.endOffset=d;S(a);v(a,"boundarychange",{startMoved:e,endMoved:f})}function y(a){this.startContainer=a;this.startOffset=0;this.endContainer=a;this.endOffset=0;this._listeners={boundarychange:[],detach:[]};S(this)}e.requireModules(["DomUtil"]);var f=e.dom,L=f.DomPosition,E=e.DOMException;h.prototype={_current:null,_next:null,_first:null,
_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next;a&&(this._next=a!==this._last?a.nextSibling:null,f.isCharacterDataNode(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so)));return a},remove:function(){var a=this._current,b,c;!f.isCharacterDataNode(a)||
a!==this.sc&&a!==this.ec?a.parentNode&&a.parentNode.removeChild(a):(b=a===this.sc?this.so:0,c=a===this.ec?this.eo:a.length,b!=c&&a.deleteData(b,c-b))},isPartiallySelectedSubtree:function(){return x(this._current,this.range)},getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse();else{a=new y(u(this.range));var b=this._current,c=b,k=0,d=b,e=f.getNodeLength(b);f.isAncestorOf(b,this.sc,!0)&&(c=this.sc,k=this.so);f.isAncestorOf(b,this.ec,!0)&&(d=this.ec,
e=this.eo);U(a,c,k,d,e)}return new h(a,this.clonePartiallySelectedTextNodes)},detach:function(a){a&&this.range.detach();this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};m.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2};m.prototype.toString=function(){return this.message};b.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){this._current=this._next;this._next=this.nodes[++this._position];return this._current},
detach:function(){this._current=this._next=this.nodes=null}};var M=[1,3,4,5,7,8,10],P=[2,9,11],N=[1,3,4,5,7,8,10,11],a=[1,3,4,5,7,8],k=f.getRootContainer,D=c([9,11]),fa=c([5,6,10,12]),ea=c([6,10,12]),da=document.createElement("style"),X=!1;try{da.innerHTML="<b>x</b>",X=3==da.firstChild.nodeType}catch(ha){}e.features.htmlParsingConforms=X;var Y="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" "),V=0,Z=1,ga=2,$=3,aa=0,ba=1,ca=2,W=3;Q.prototype={attachListener:function(a,
b){this._listeners[a].push(b)},compareBoundaryPoints:function(a,b){w(this);H(this.startContainer,b.startContainer);var c=a==$||a==V?"start":"end",k=a==Z||a==V?"start":"end";return f.comparePoints(this[c+"Container"],this[c+"Offset"],b[k+"Container"],b[k+"Offset"])},insertNode:function(a){w(this);F(a,N);G(this.startContainer);if(f.isAncestorOf(a,this.startContainer,!0))throw new E("HIERARCHY_REQUEST_ERR");this.setStartBefore(A(a,this.startContainer,this.startOffset))},cloneContents:function(){w(this);
var a,b;if(this.collapsed)return u(this).createDocumentFragment();if(this.startContainer===this.endContainer&&f.isCharacterDataNode(this.startContainer))return a=this.startContainer.cloneNode(!0),a.data=a.data.slice(this.startOffset,this.endOffset),b=u(this).createDocumentFragment(),b.appendChild(a),b;b=new h(this,!0);a=C(b);b.detach();return a},canSurroundContents:function(){w(this);G(this.startContainer);G(this.endContainer);var a=new h(this,!0),b=a._first&&x(a._first,this)||a._last&&x(a._last,
this);a.detach();return!b},surroundContents:function(b){F(b,a);if(!this.canSurroundContents())throw new m("BAD_BOUNDARYPOINTS_ERR");var c=this.extractContents();if(b.hasChildNodes())for(;b.lastChild;)b.removeChild(b.lastChild);A(b,this.startContainer,this.startOffset);b.appendChild(c);this.selectNode(b)},cloneRange:function(){w(this);for(var a=new y(u(this)),b=Y.length,c;b--;)c=Y[b],a[c]=this[c];return a},toString:function(){w(this);var a=this.startContainer;if(a===this.endContainer&&f.isCharacterDataNode(a))return 3==
a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var b=[],a=new h(this,!0);d(a,function(a){3!=a.nodeType&&4!=a.nodeType||b.push(a.data)});a.detach();return b.join("")},compareNode:function(a){w(this);var b=a.parentNode,c=f.getNodeIndex(a);if(!b)throw new E("NOT_FOUND_ERR");a=this.comparePoint(b,c);b=this.comparePoint(b,c+1);return 0>a?0<b?ca:aa:0<b?ba:W},comparePoint:function(a,b){w(this);z(a,"HIERARCHY_REQUEST_ERR");H(a,this.startContainer);return 0>f.comparePoints(a,b,
this.startContainer,this.startOffset)?-1:0<f.comparePoints(a,b,this.endContainer,this.endOffset)?1:0},createContextualFragment:X?function(a){var b=this.startContainer,c=f.getDocument(b);if(!b)throw new E("INVALID_STATE_ERR");var k=null;1==b.nodeType?k=b:f.isCharacterDataNode(b)&&(k=f.parentElement(b));k=null===k||"HTML"==k.nodeName&&f.isHtmlNamespace(f.getDocument(k).documentElement)&&f.isHtmlNamespace(k)?c.createElement("body"):k.cloneNode(!1);k.innerHTML=a;return f.fragmentFromNodeChildren(k)}:
function(a){t(this);var b=u(this).createElement("body");b.innerHTML=a;return f.fragmentFromNodeChildren(b)},toHtml:function(){w(this);var a=u(this).createElement("div");a.appendChild(this.cloneContents());return a.innerHTML},intersectsNode:function(a,b){w(this);z(a,"NOT_FOUND_ERR");if(f.getDocument(a)!==u(this))return!1;var c=a.parentNode,k=f.getNodeIndex(a);z(c,"NOT_FOUND_ERR");var d=f.comparePoints(c,k,this.endContainer,this.endOffset),c=f.comparePoints(c,k+1,this.startContainer,this.startOffset);
return b?0>=d&&0<=c:0>d&&0<c},isPointInRange:function(a,b){w(this);z(a,"HIERARCHY_REQUEST_ERR");H(a,this.startContainer);return 0<=f.comparePoints(a,b,this.startContainer,this.startOffset)&&0>=f.comparePoints(a,b,this.endContainer,this.endOffset)},intersectsRange:function(a,b){w(this);if(u(a)!=u(this))throw new E("WRONG_DOCUMENT_ERR");var c=f.comparePoints(this.startContainer,this.startOffset,a.endContainer,a.endOffset),k=f.comparePoints(this.endContainer,this.endOffset,a.startContainer,a.startOffset);
return b?0>=c&&0<=k:0>c&&0<k},intersection:function(a){if(this.intersectsRange(a)){var b=f.comparePoints(this.startContainer,this.startOffset,a.startContainer,a.startOffset),c=f.comparePoints(this.endContainer,this.endOffset,a.endContainer,a.endOffset),k=this.cloneRange();-1==b&&k.setStart(a.startContainer,a.startOffset);1==c&&k.setEnd(a.endContainer,a.endOffset);return k}return null},union:function(a){if(this.intersectsRange(a,!0)){var b=this.cloneRange();-1==f.comparePoints(a.startContainer,a.startOffset,
this.startContainer,this.startOffset)&&b.setStart(a.startContainer,a.startOffset);1==f.comparePoints(a.endContainer,a.endOffset,this.endContainer,this.endOffset)&&b.setEnd(a.endContainer,a.endOffset);return b}throw new m("Ranges do not intersect");},containsNode:function(a,b){return b?this.intersectsNode(a,!1):this.compareNode(a)==W},containsNodeContents:function(a){return 0<=this.comparePoint(a,0)&&0>=this.comparePoint(a,f.getNodeLength(a))},containsRange:function(a){return this.intersection(a).equals(a)},
containsNodeText:function(a){var b=this.cloneRange();b.selectNode(a);var c=b.getNodes([3]);return 0<c.length?(b.setStart(c[0],0),a=c.pop(),b.setEnd(a,a.length),a=this.containsRange(b),b.detach(),a):this.containsNodeContents(a)},createNodeIterator:function(a,c){w(this);return new b(this,a,c)},getNodes:function(a,b){w(this);return n(this,a,b)},getDocument:function(){return u(this)},collapseBefore:function(a){t(this);this.setEndBefore(a);this.collapse(!1)},collapseAfter:function(a){t(this);this.setStartAfter(a);
this.collapse(!0)},getName:function(){return"DomRange"},equals:function(a){return y.rangesEqual(this,a)},isValid:function(){return J(this)},inspect:function(){return r(this)}};T(y,U,function(a){t(a);a.startContainer=a.startOffset=a.endContainer=a.endOffset=null;a.collapsed=a.commonAncestorContainer=null;v(a,"detach",null);a._listeners=null});e.rangePrototype=Q.prototype;y.rangeProperties=Y;y.RangeIterator=h;y.copyComparisonConstants=I;y.createPrototypeRange=T;y.inspect=r;y.getRangeDocument=u;y.rangesEqual=
function(a,b){return a.startContainer===b.startContainer&&a.startOffset===b.startOffset&&a.endContainer===b.endContainer&&a.endOffset===b.endOffset};e.DomRange=y;e.RangeException=m});
rangy.createModule("WrappedRange",function(e){function x(d,e,l,n){var r=d.duplicate();r.collapse(l);var h=r.parentElement();q.isAncestorOf(e,h,!0)||(h=e);if(!h.canHaveHTML)return new s(h.parentNode,q.getNodeIndex(h));e=q.getDocument(h).createElement("span");var m,b=l?"StartToStart":"StartToEnd";do h.insertBefore(e,e.previousSibling),r.moveToElementText(e);while(0<(m=r.compareEndPoints(b,d))&&e.previousSibling);b=e.nextSibling;if(-1==m&&b&&q.isCharacterDataNode(b)){r.setEndPoint(l?"EndToStart":"EndToEnd",
d);if(/[\r\n]/.test(b.data))for(h=r.duplicate(),l=h.text.replace(/\r\n/g,"\r").length,l=h.moveStart("character",l);-1==h.compareEndPoints("StartToEnd",h);)l++,h.moveStart("character",1);else l=r.text.length;h=new s(b,l)}else b=(n||!l)&&e.previousSibling,h=(l=(n||l)&&e.nextSibling)&&q.isCharacterDataNode(l)?new s(l,0):b&&q.isCharacterDataNode(b)?new s(b,b.length):new s(h,q.getNodeIndex(e));e.parentNode.removeChild(e);return h}function u(d,e){var l,n,r=d.offset,h=q.getDocument(d.node),m=h.body.createTextRange(),
b=q.isCharacterDataNode(d.node);b?(l=d.node,n=l.parentNode):(l=d.node.childNodes,l=r<l.length?l[r]:null,n=d.node);h=h.createElement("span");h.innerHTML="&#feff;";l?n.insertBefore(h,l):n.appendChild(h);m.moveToElementText(h);m.collapse(!e);n.removeChild(h);if(b)m[e?"moveStart":"moveEnd"]("character",r);return m}e.requireModules(["DomUtil","DomRange"]);var v,q=e.dom,s=q.DomPosition,A=e.DomRange;if(e.features.implementsDomRange&&(!e.features.implementsTextRange||!e.config.preferTextRange))(function(){function d(b){for(var d=
l.length,e;d--;)e=l[d],b[e]=b.nativeRange[e]}var p,l=A.rangeProperties,n,r;v=function(b){if(!b)throw Error("Range must be specified");this.nativeRange=b;d(this)};A.createPrototypeRange(v,function(b,d,e,h,l){var p=b.endContainer!==h||b.endOffset!=l;if(b.startContainer!==d||b.startOffset!=e||p)b.setEnd(h,l),b.setStart(d,e)},function(b){b.nativeRange.detach();b.detached=!0;for(var d=l.length,e;d--;)e=l[d],b[e]=null});p=v.prototype;p.selectNode=function(b){this.nativeRange.selectNode(b);d(this)};p.deleteContents=
function(){this.nativeRange.deleteContents();d(this)};p.extractContents=function(){var b=this.nativeRange.extractContents();d(this);return b};p.cloneContents=function(){return this.nativeRange.cloneContents()};p.surroundContents=function(b){this.nativeRange.surroundContents(b);d(this)};p.collapse=function(b){this.nativeRange.collapse(b);d(this)};p.cloneRange=function(){return new v(this.nativeRange.cloneRange())};p.refresh=function(){d(this)};p.toString=function(){return this.nativeRange.toString()};
var h=document.createTextNode("test");q.getBody(document).appendChild(h);var m=document.createRange();m.setStart(h,0);m.setEnd(h,0);try{m.setStart(h,1),n=!0,p.setStart=function(b,e){this.nativeRange.setStart(b,e);d(this)},p.setEnd=function(b,e){this.nativeRange.setEnd(b,e);d(this)},r=function(b){return function(e){this.nativeRange[b](e);d(this)}}}catch(b){n=!1,p.setStart=function(b,e){try{this.nativeRange.setStart(b,e)}catch(h){this.nativeRange.setEnd(b,e),this.nativeRange.setStart(b,e)}d(this)},
p.setEnd=function(b,e){try{this.nativeRange.setEnd(b,e)}catch(h){this.nativeRange.setStart(b,e),this.nativeRange.setEnd(b,e)}d(this)},r=function(b,e){return function(h){try{this.nativeRange[b](h)}catch(l){this.nativeRange[e](h),this.nativeRange[b](h)}d(this)}}}p.setStartBefore=r("setStartBefore","setEndBefore");p.setStartAfter=r("setStartAfter","setEndAfter");p.setEndBefore=r("setEndBefore","setStartBefore");p.setEndAfter=r("setEndAfter","setStartAfter");m.selectNodeContents(h);p.selectNodeContents=
m.startContainer==h&&m.endContainer==h&&0==m.startOffset&&m.endOffset==h.length?function(b){this.nativeRange.selectNodeContents(b);d(this)}:function(b){this.setStart(b,0);this.setEnd(b,A.getEndOffset(b))};m.selectNodeContents(h);m.setEnd(h,3);n=document.createRange();n.selectNodeContents(h);n.setEnd(h,4);n.setStart(h,2);p.compareBoundaryPoints=-1==m.compareBoundaryPoints(m.START_TO_END,n)&1==m.compareBoundaryPoints(m.END_TO_START,n)?function(b,d){d=d.nativeRange||d;b==d.START_TO_END?b=d.END_TO_START:
b==d.END_TO_START&&(b=d.START_TO_END);return this.nativeRange.compareBoundaryPoints(b,d)}:function(b,d){return this.nativeRange.compareBoundaryPoints(b,d.nativeRange||d)};e.util.isHostMethod(m,"createContextualFragment")&&(p.createContextualFragment=function(b){return this.nativeRange.createContextualFragment(b)});q.getBody(document).removeChild(h);m.detach();n.detach()})(),e.createNativeRange=function(d){d=d||document;return d.createRange()};else if(e.features.implementsTextRange){v=function(d){this.textRange=
d;this.refresh()};v.prototype=new A(document);v.prototype.refresh=function(){var d,e,l=this.textRange;d=l.parentElement();var n=l.duplicate();n.collapse(!0);e=n.parentElement();n=l.duplicate();n.collapse(!1);l=n.parentElement();e=e==l?e:q.getCommonAncestor(e,l);e=e==d?e:q.getCommonAncestor(d,e);0==this.textRange.compareEndPoints("StartToEnd",this.textRange)?e=d=x(this.textRange,e,!0,!0):(d=x(this.textRange,e,!0,!1),e=x(this.textRange,e,!1,!1));this.setStart(d.node,d.offset);this.setEnd(e.node,e.offset)};
A.copyComparisonConstants(v);var C=function(){return this}();"undefined"==typeof C.Range&&(C.Range=v);e.createNativeRange=function(d){d=d||document;return d.body.createTextRange()}}e.features.implementsTextRange&&(v.rangeToTextRange=function(d){if(d.collapsed)return u(new s(d.startContainer,d.startOffset),!0);var e=u(new s(d.startContainer,d.startOffset),!0),l=u(new s(d.endContainer,d.endOffset),!1);d=q.getDocument(d.startContainer).body.createTextRange();d.setEndPoint("StartToStart",e);d.setEndPoint("EndToEnd",
l);return d});v.prototype.getName=function(){return"WrappedRange"};e.WrappedRange=v;e.createRange=function(d){d=d||document;return new v(e.createNativeRange(d))};e.createRangyRange=function(d){d=d||document;return new A(d)};e.createIframeRange=function(d){return e.createRange(q.getIframeDocument(d))};e.createIframeRangyRange=function(d){return e.createRangyRange(q.getIframeDocument(d))};e.addCreateMissingNativeApiListener(function(d){d=d.document;"undefined"==typeof d.createRange&&(d.createRange=
function(){return e.createRange(this)});d=d=null})});
rangy.createModule("WrappedSelection",function(e,x){function u(a){return(a||window).getSelection()}function v(a){return(a||window).document.selection}function q(a,b,c){var d=c?"end":"start";c=c?"start":"end";a.anchorNode=b[d+"Container"];a.anchorOffset=b[d+"Offset"];a.focusNode=b[c+"Container"];a.focusOffset=b[c+"Offset"]}function s(a){a.anchorNode=a.focusNode=null;a.anchorOffset=a.focusOffset=0;a.rangeCount=0;a.isCollapsed=!0;a._ranges.length=0}function A(a){var k;a instanceof B?(k=a._selectionNativeRange,
k||(k=e.createNativeRange(b.getDocument(a.startContainer)),k.setEnd(a.endContainer,a.endOffset),k.setStart(a.startContainer,a.startOffset),a._selectionNativeRange=k,a.attachListener("detach",function(){this._selectionNativeRange=null}))):a instanceof t?k=a.nativeRange:e.features.implementsDomRange&&a instanceof b.getWindow(a.startContainer).Range&&(k=a);return k}function C(a){var k=a.getNodes(),c;a:if(k.length&&1==k[0].nodeType){c=1;for(var d=k.length;c<d;++c)if(!b.isAncestorOf(k[0],k[c])){c=!1;break a}c=
!0}else c=!1;if(!c)throw Error("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");return k[0]}function d(a,b){var c=new t(b);a._ranges=[c];q(a,c,!1);a.rangeCount=1;a.isCollapsed=c.collapsed}function p(a){a._ranges.length=0;if("None"==a.docSelection.type)s(a);else{var c=a.docSelection.createRange();if(c&&"undefined"!=typeof c.text)d(a,c);else{a.rangeCount=c.length;for(var f,h=b.getDocument(c.item(0)),l=0;l<a.rangeCount;++l)f=e.createRange(h),f.selectNode(c.item(l)),
a._ranges.push(f);a.isCollapsed=1==a.rangeCount&&a._ranges[0].collapsed;q(a,a._ranges[a.rangeCount-1],!1)}}}function l(a,c){for(var d=a.docSelection.createRange(),e=C(c),f=b.getDocument(d.item(0)),f=b.getBody(f).createControlRange(),h=0,l=d.length;h<l;++h)f.add(d.item(h));try{f.add(e)}catch(m){throw Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)");}f.select();p(a)}function n(a,b,c){this.nativeSelection=a;this.docSelection=b;this._ranges=
[];this.win=c;this.refresh()}function r(a,c){for(var d=b.getDocument(c[0].startContainer),d=b.getBody(d).createControlRange(),e=0,f;e<rangeCount;++e){f=C(c[e]);try{d.add(f)}catch(h){throw Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)");}}d.select();p(a)}function h(a,c){if(a.anchorNode&&b.getDocument(a.anchorNode)!==b.getDocument(c))throw new F("WRONG_DOCUMENT_ERR");}function m(a){var b=[],c=new O(a.anchorNode,a.anchorOffset),
d=new O(a.focusNode,a.focusOffset),e="function"==typeof a.getName?a.getName():"Selection";if("undefined"!=typeof a.rangeCount)for(var f=0,h=a.rangeCount;f<h;++f)b[f]=B.inspect(a.getRangeAt(f));return"["+e+"(Ranges: "+b.join(", ")+")(anchor: "+c.inspect()+", focus: "+d.inspect()+"]"}e.requireModules(["DomUtil","DomRange","WrappedRange"]);e.config.checkSelectionRanges=!0;var b=e.dom,c=e.util,B=e.DomRange,t=e.WrappedRange,F=e.DOMException,O=b.DomPosition,H,G,z=e.util.isHostMethod(window,"getSelection"),
J=e.util.isHostObject(document,"selection"),w=J&&(!z||e.config.preferTextRange);w?(H=v,e.isSelectionValid=function(a){a=(a||window).document;var c=a.selection;return"None"!=c.type||b.getDocument(c.createRange().parentElement())==a}):z?(H=u,e.isSelectionValid=function(){return!0}):x.fail("Neither document.selection or window.getSelection() detected.");e.getNativeSelection=H;var z=H(),Q=e.createNativeRange(document),K=b.getBody(document),I=c.areHostObjects(z,c.areHostProperties(z,["anchorOffset","focusOffset"]));
e.features.selectionHasAnchorAndFocus=I;var R=c.isHostMethod(z,"extend");e.features.selectionHasExtend=R;var T="number"==typeof z.rangeCount;e.features.selectionHasRangeCount=T;var S=!1,U=!0;c.areHostMethods(z,["addRange","getRangeAt","removeAllRanges"])&&"number"==typeof z.rangeCount&&e.features.implementsDomRange&&function(){var a=document.createElement("iframe");a.frameBorder=0;a.style.position="absolute";a.style.left="-10000px";K.appendChild(a);var c=b.getIframeDocument(a);c.open();c.write("<html><head></head><body>12</body></html>");
c.close();var d=b.getIframeWindow(a).getSelection(),e=c.documentElement.lastChild.firstChild,c=c.createRange();c.setStart(e,1);c.collapse(!0);d.addRange(c);U=1==d.rangeCount;d.removeAllRanges();var f=c.cloneRange();c.setStart(e,0);f.setEnd(e,2);d.addRange(c);d.addRange(f);S=2==d.rangeCount;c.detach();f.detach();K.removeChild(a)}();e.features.selectionSupportsMultipleRanges=S;e.features.collapsedNonEditableSelectionsSupported=U;var y=!1,f;K&&c.isHostMethod(K,"createControlRange")&&(f=K.createControlRange(),
c.areHostProperties(f,["item","add"])&&(y=!0));e.features.implementsControlRange=y;G=I?function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:!1};var L;c.isHostMethod(z,"getRangeAt")?L=function(a,b){try{return a.getRangeAt(b)}catch(c){return null}}:I&&(L=function(a){var c=b.getDocument(a.anchorNode),c=e.createRange(c);c.setStart(a.anchorNode,a.anchorOffset);c.setEnd(a.focusNode,a.focusOffset);c.collapsed!==
this.isCollapsed&&(c.setStart(a.focusNode,a.focusOffset),c.setEnd(a.anchorNode,a.anchorOffset));return c});e.getSelection=function(a){a=a||window;var b=a._rangySelection,c=H(a),d=J?v(a):null;b?(b.nativeSelection=c,b.docSelection=d,b.refresh(a)):(b=new n(c,d,a),a._rangySelection=b);return b};e.getIframeSelection=function(a){return e.getSelection(b.getIframeWindow(a))};f=n.prototype;if(!w&&I&&c.areHostMethods(z,["removeAllRanges","addRange"])){f.removeAllRanges=function(){this.nativeSelection.removeAllRanges();
s(this)};var E=function(a,b){var c=B.getRangeDocument(b),c=e.createRange(c);c.collapseToPoint(b.endContainer,b.endOffset);a.nativeSelection.addRange(A(c));a.nativeSelection.extend(b.startContainer,b.startOffset);a.refresh()};f.addRange=T?function(a,b){if(y&&J&&"Control"==this.docSelection.type)l(this,a);else if(b&&R)E(this,a);else{var c;S?c=this.rangeCount:(this.removeAllRanges(),c=0);this.nativeSelection.addRange(A(a));this.rangeCount=this.nativeSelection.rangeCount;this.rangeCount==c+1?(e.config.checkSelectionRanges&&
(c=L(this.nativeSelection,this.rangeCount-1))&&!B.rangesEqual(c,a)&&(a=new t(c)),this._ranges[this.rangeCount-1]=a,q(this,a,N(this.nativeSelection)),this.isCollapsed=G(this)):this.refresh()}}:function(a,b){b&&R?E(this,a):(this.nativeSelection.addRange(A(a)),this.refresh())};f.setRanges=function(a){if(y&&1<a.length)r(this,a);else{this.removeAllRanges();for(var b=0,c=a.length;b<c;++b)this.addRange(a[b])}}}else if(c.isHostMethod(z,"empty")&&c.isHostMethod(Q,"select")&&y&&w)f.removeAllRanges=function(){try{if(this.docSelection.empty(),
"None"!=this.docSelection.type){var a;if(this.anchorNode)a=b.getDocument(this.anchorNode);else if("Control"==this.docSelection.type){var c=this.docSelection.createRange();c.length&&(a=b.getDocument(c.item(0)).body.createTextRange())}a&&(a.body.createTextRange().select(),this.docSelection.empty())}}catch(d){}s(this)},f.addRange=function(a){"Control"==this.docSelection.type?l(this,a):(t.rangeToTextRange(a).select(),this._ranges[0]=a,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,q(this,
a,!1))},f.setRanges=function(a){this.removeAllRanges();var b=a.length;1<b?r(this,a):b&&this.addRange(a[0])};else return x.fail("No means of selecting a Range or TextRange was found"),!1;f.getRangeAt=function(a){if(0>a||a>=this.rangeCount)throw new F("INDEX_SIZE_ERR");return this._ranges[a]};var M;if(w)M=function(a){var c;e.isSelectionValid(a.win)?c=a.docSelection.createRange():(c=b.getBody(a.win.document).createTextRange(),c.collapse(!0));"Control"==a.docSelection.type?p(a):c&&"undefined"!=typeof c.text?
d(a,c):s(a)};else if(c.isHostMethod(z,"getRangeAt")&&"number"==typeof z.rangeCount)M=function(a){if(y&&J&&"Control"==a.docSelection.type)p(a);else if(a._ranges.length=a.rangeCount=a.nativeSelection.rangeCount,a.rangeCount){for(var b=0,c=a.rangeCount;b<c;++b)a._ranges[b]=new e.WrappedRange(a.nativeSelection.getRangeAt(b));q(a,a._ranges[a.rangeCount-1],N(a.nativeSelection));a.isCollapsed=G(a)}else s(a)};else if(I&&"boolean"==typeof z.isCollapsed&&"boolean"==typeof Q.collapsed&&e.features.implementsDomRange)M=
function(a){var b;b=a.nativeSelection;b.anchorNode?(b=L(b,0),a._ranges=[b],a.rangeCount=1,b=a.nativeSelection,a.anchorNode=b.anchorNode,a.anchorOffset=b.anchorOffset,a.focusNode=b.focusNode,a.focusOffset=b.focusOffset,a.isCollapsed=G(a)):s(a)};else return x.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;f.refresh=function(a){var b=a?this._ranges.slice(0):null;M(this);if(a){a=b.length;if(a!=this._ranges.length)return!1;for(;a--;)if(!B.rangesEqual(b[a],this._ranges[a]))return!1;
return!0}};var P=function(a,b){var c=a.getAllRanges(),d=!1;a.removeAllRanges();for(var e=0,f=c.length;e<f;++e)d||b!==c[e]?a.addRange(c[e]):d=!0;a.rangeCount||s(a)};f.removeRange=y?function(a){if("Control"==this.docSelection.type){var c=this.docSelection.createRange();a=C(a);for(var d=b.getDocument(c.item(0)),d=b.getBody(d).createControlRange(),e,f=!1,h=0,l=c.length;h<l;++h)e=c.item(h),e!==a||f?d.add(c.item(h)):f=!0;d.select();p(this)}else P(this,a)}:function(a){P(this,a)};var N;!w&&I&&e.features.implementsDomRange?
(N=function(a){var c=!1;a.anchorNode&&(c=1==b.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset));return c},f.isBackwards=function(){return N(this)}):N=f.isBackwards=function(){return!1};f.toString=function(){for(var a=[],b=0,c=this.rangeCount;b<c;++b)a[b]=""+this._ranges[b];return a.join("")};f.collapse=function(a,c){h(this,a);var d=e.createRange(b.getDocument(a));d.collapseToPoint(a,c);this.removeAllRanges();this.addRange(d);this.isCollapsed=!0};f.collapseToStart=function(){if(this.rangeCount){var a=
this._ranges[0];this.collapse(a.startContainer,a.startOffset)}else throw new F("INVALID_STATE_ERR");};f.collapseToEnd=function(){if(this.rangeCount){var a=this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)}else throw new F("INVALID_STATE_ERR");};f.selectAllChildren=function(a){h(this,a);var c=e.createRange(b.getDocument(a));c.selectNodeContents(a);this.removeAllRanges();this.addRange(c)};f.deleteFromDocument=function(){if(y&&J&&"Control"==this.docSelection.type){for(var a=this.docSelection.createRange(),
b;a.length;)b=a.item(0),a.remove(b),b.parentNode.removeChild(b);this.refresh()}else if(this.rangeCount){a=this.getAllRanges();this.removeAllRanges();b=0;for(var c=a.length;b<c;++b)a[b].deleteContents();this.addRange(a[c-1])}};f.getAllRanges=function(){return this._ranges.slice(0)};f.setSingleRange=function(a){this.setRanges([a])};f.containsNode=function(a,b){for(var c=0,d=this._ranges.length;c<d;++c)if(this._ranges[c].containsNode(a,b))return!0;return!1};f.toHtml=function(){var a="";if(this.rangeCount){for(var a=
B.getRangeDocument(this._ranges[0]).createElement("div"),b=0,c=this._ranges.length;b<c;++b)a.appendChild(this._ranges[b].cloneContents());a=a.innerHTML}return a};f.getName=function(){return"WrappedSelection"};f.inspect=function(){return m(this)};f.detach=function(){this.win=this.anchorNode=this.focusNode=this.win._rangySelection=null};n.inspect=m;e.Selection=n;e.selectionPrototype=f;e.addCreateMissingNativeApiListener(function(a){"undefined"==typeof a.getSelection&&(a.getSelection=function(){return e.getSelection(this)});
a=null})});